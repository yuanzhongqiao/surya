<div class="Box-sc-g0xbh4-0 bJMeLZ js-snippet-clipboard-copy-unpositioned" data-hpc="true"><article class="markdown-body entry-content container-lg" itemprop="text"><div class="markdown-heading" dir="auto"><h1 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">苏里亚</font></font></h1><a id="user-content-surya" class="anchor" aria-label="固定链接：Surya" href="#surya"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Surya 是一个文档 OCR 工具包，其功能如下：</font></font></p>
<ul dir="auto">
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">支持 90 多种语言的 OCR，与云服务相比具有优势</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">任何语言的行级文本检测</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">布局分析（表格、图像、标题等检测）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">阅读顺序检测</font></font></li>
</ul>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">它适用于一系列文档（有关更多详细信息，请参阅</font></font><a href="#usage"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用情况</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><a href="#benchmarks"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">基准</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font></p>
<table>
<thead>
<tr>
<th align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">检测</font></font></th>
<th align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">光学字符识别 (OCR)</font></font></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><a target="_blank" rel="noopener noreferrer" href="https://github.com/VikParuchuri/surya/blob/master/static/images/excerpt.png"><img src="https://github.com/VikParuchuri/surya/raw/master/static/images/excerpt.png" alt="纽约时报文章检测" style="max-width: 100%;"></a></td>
<td align="center"><a target="_blank" rel="noopener noreferrer" href="https://github.com/VikParuchuri/surya/blob/master/static/images/excerpt_text.png"><img src="https://github.com/VikParuchuri/surya/raw/master/static/images/excerpt_text.png" alt="《纽约时报》文章识别" style="max-width: 100%;"></a></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">布局</font></font></th>
<th align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">阅读顺序</font></font></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><a target="_blank" rel="noopener noreferrer" href="https://github.com/VikParuchuri/surya/blob/master/static/images/excerpt_layout.png"><img src="https://github.com/VikParuchuri/surya/raw/master/static/images/excerpt_layout.png" alt="纽约时报文章布局" style="max-width: 100%;"></a></td>
<td align="center"><a target="_blank" rel="noopener noreferrer" href="https://github.com/VikParuchuri/surya/blob/master/static/images/excerpt_reading.jpg"><img src="https://github.com/VikParuchuri/surya/raw/master/static/images/excerpt_reading.jpg" alt="纽约时报文章阅读顺序" style="max-width: 100%;"></a></td>
</tr>
</tbody>
</table>
<p dir="auto"><font style="vertical-align: inherit;"></font><a href="https://en.wikipedia.org/wiki/Surya" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">苏利耶（Surya）以印度教太阳神</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的名字命名</font><font style="vertical-align: inherit;">，他具有宇宙视野。</font></font></p>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">社区</font></font></h2><a id="user-content-community" class="anchor" aria-label="固定链接：社区" href="#community"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><a href="https://discord.gg//KuZwXNGnfH" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Discord</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是我们讨论未来发展的地方。</font></font></p>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例子</font></font></h2><a id="user-content-examples" class="anchor" aria-label="永久链接：示例" href="#examples"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<table>
<thead>
<tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">姓名</font></font></th>
<th align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">检测</font></font></th>
<th align="right"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">光学字符识别 (OCR)</font></font></th>
<th align="right"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">布局</font></font></th>
<th align="right"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令</font></font></th>
</tr>
</thead>
<tbody>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">日本人</font></font></td>
<td align="center"><a href="/VikParuchuri/surya/blob/master/static/images/japanese.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
<td align="right"><a href="/VikParuchuri/surya/blob/master/static/images/japanese_text.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
<td align="right"><a href="/VikParuchuri/surya/blob/master/static/images/japanese_layout.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
<td align="right"><a href="/VikParuchuri/surya/blob/master/static/images/japanese_reading.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中国人</font></font></td>
<td align="center"><a href="/VikParuchuri/surya/blob/master/static/images/chinese.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
<td align="right"><a href="/VikParuchuri/surya/blob/master/static/images/chinese_text.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
<td align="right"><a href="/VikParuchuri/surya/blob/master/static/images/chinese_layout.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
<td align="right"><a href="/VikParuchuri/surya/blob/master/static/images/chinese_reading.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">印地语</font></font></td>
<td align="center"><a href="/VikParuchuri/surya/blob/master/static/images/hindi.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
<td align="right"><a href="/VikParuchuri/surya/blob/master/static/images/hindi_text.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
<td align="right"><a href="/VikParuchuri/surya/blob/master/static/images/hindi_layout.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
<td align="right"><a href="/VikParuchuri/surya/blob/master/static/images/hindi_reading.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">阿拉伯</font></font></td>
<td align="center"><a href="/VikParuchuri/surya/blob/master/static/images/arabic.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
<td align="right"><a href="/VikParuchuri/surya/blob/master/static/images/arabic_text.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
<td align="right"><a href="/VikParuchuri/surya/blob/master/static/images/arabic_layout.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
<td align="right"><a href="/VikParuchuri/surya/blob/master/static/images/arabic_reading.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中文 + 印地语</font></font></td>
<td align="center"><a href="/VikParuchuri/surya/blob/master/static/images/chi_hind.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
<td align="right"><a href="/VikParuchuri/surya/blob/master/static/images/chi_hind_text.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
<td align="right"><a href="/VikParuchuri/surya/blob/master/static/images/chi_hind_layout.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
<td align="right"><a href="/VikParuchuri/surya/blob/master/static/images/chi_hind_reading.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">推介会</font></font></td>
<td align="center"><a href="/VikParuchuri/surya/blob/master/static/images/pres.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
<td align="right"><a href="/VikParuchuri/surya/blob/master/static/images/pres_text.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
<td align="right"><a href="/VikParuchuri/surya/blob/master/static/images/pres_layout.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
<td align="right"><a href="/VikParuchuri/surya/blob/master/static/images/pres_reading.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">科学论文</font></font></td>
<td align="center"><a href="/VikParuchuri/surya/blob/master/static/images/paper.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
<td align="right"><a href="/VikParuchuri/surya/blob/master/static/images/paper_text.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
<td align="right"><a href="/VikParuchuri/surya/blob/master/static/images/paper_layout.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
<td align="right"><a href="/VikParuchuri/surya/blob/master/static/images/paper_reading.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">扫描文件</font></font></td>
<td align="center"><a href="/VikParuchuri/surya/blob/master/static/images/scanned.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
<td align="right"><a href="/VikParuchuri/surya/blob/master/static/images/scanned_text.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
<td align="right"><a href="/VikParuchuri/surya/blob/master/static/images/scanned_layout.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
<td align="right"><a href="/VikParuchuri/surya/blob/master/static/images/scanned_reading.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">纽约时报</font></font></td>
<td align="center"><a href="/VikParuchuri/surya/blob/master/static/images/nyt.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
<td align="right"><a href="/VikParuchuri/surya/blob/master/static/images/nyt_text.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
<td align="right"><a href="/VikParuchuri/surya/blob/master/static/images/nyt_layout.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
<td align="right"><a href="/VikParuchuri/surya/blob/master/static/images/nyt_order.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">扫描表格</font></font></td>
<td align="center"><a href="/VikParuchuri/surya/blob/master/static/images/funsd.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
<td align="right"><a href="/VikParuchuri/surya/blob/master/static/images/funsd_text.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
<td align="right"><a href="/VikParuchuri/surya/blob/master/static/images/funsd_layout.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
<td align="right"><a href="/VikParuchuri/surya/blob/master/static/images/funsd_reading.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">教科书</font></font></td>
<td align="center"><a href="/VikParuchuri/surya/blob/master/static/images/textbook.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
<td align="right"><a href="/VikParuchuri/surya/blob/master/static/images/textbook_text.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
<td align="right"><a href="/VikParuchuri/surya/blob/master/static/images/textbook_layout.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
<td align="right"><a href="/VikParuchuri/surya/blob/master/static/images/textbook_order.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></a></td>
</tr>
</tbody>
</table>
<div class="markdown-heading" dir="auto"><h1 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">商业用途</font></font></h1><a id="user-content-commercial-usage" class="anchor" aria-label="永久链接：商业用途" href="#commercial-usage"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我希望 surya 能够尽可能广泛地普及，同时仍能为我的开发/培训费用提供资金。研究和个人使用始终是可以的，但商业使用会受到一些限制。</font></font></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这些模型的权重是经过授权的</font></font><code>cc-by-nc-sa-4.0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，但对于最近 12 个月内总收入低于 500 万美元且一生中筹集的 VC/天使资金低于 500 万美元的任何组织，我将免除该授权。如果您想删除 GPL 许可要求（双重许可）和/或在收入限制之外将权重用于商业用途，请查看</font></font><a href="https://www.datalab.to" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">此处的</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项。</font></font></p>
<div class="markdown-heading" dir="auto"><h1 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安装</font></font></h1><a id="user-content-installation" class="anchor" aria-label="固定链接：安装" href="#installation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您需要 Python 3.9+ 和 PyTorch。如果您使用的不是 Mac 或 GPU 机器，则可能需要先安装 CPU 版本的 torch。请参阅</font></font><a href="https://pytorch.org/get-started/locally/" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">此处</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">了解更多详细信息。</font></font></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安装方式：</font></font></p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto"><pre>pip install surya-ocr</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 tooltipped-no-delay d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="pip install surya-ocr" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">首次运行 surya 时，模型权重将自动下载。请注意，此功能尚不适用于最新版本的 transformers </font></font><code>4.37+</code> <a href="https://github.com/huggingface/transformers/issues/28846#issuecomment-1926109135" data-hovercard-type="issue" data-hovercard-url="/huggingface/transformers/issues/28846/hovercard"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">因此您需要保留</font></font><code>4.36.2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">随 surya 一起安装的。</font></font></p>
<div class="markdown-heading" dir="auto"><h1 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用法</font></font></h1><a id="user-content-usage" class="anchor" aria-label="固定链接：用法" href="#usage"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">检查中的设置</font></font><code>surya/settings.py</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。您可以使用环境变量覆盖任何设置。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您的 Torch 设备将被自动检测，但您可以覆盖此设置。例如，</font></font><code>TORCH_DEVICE=cuda</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。对于文本检测，该</font></font><code>mps</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">设备有一个错误（在</font></font><a href="https://github.com/pytorch/pytorch/issues/84936" data-hovercard-type="issue" data-hovercard-url="/pytorch/pytorch/issues/84936/hovercard"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apple 方面</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），可能会阻止其正常工作。</font></font></li>
</ul>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">互动应用程序</font></font></h2><a id="user-content-interactive-app" class="anchor" aria-label="固定链接：互动应用程序" href="#interactive-app"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我提供了一个 streamlit 应用程序，可让您以交互方式在图像或 PDF 文件上试用 Surya。使用以下命令运行它：</font></font></p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto"><pre>pip install streamlit
surya_gui</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 tooltipped-no-delay d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="pip install streamlit
surya_gui" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">传递</font></font><code>--math</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令行参数以使用数学文本检测模型而不是默认模型。这将更好地检测数学，但其他方面会更差。</font></font></p>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OCR（文本识别）</font></font></h2><a id="user-content-ocr-text-recognition" class="anchor" aria-label="永久链接：OCR（文本识别）" href="#ocr-text-recognition"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">此命令将写出包含检测到的文本和 bbox 的 json 文件：</font></font></p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto"><pre>surya_ocr DATA_PATH --images --langs hi,en</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 tooltipped-no-delay d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="surya_ocr DATA_PATH --images --langs hi,en" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<ul dir="auto">
<li><code>DATA_PATH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以是图像、pdf 或图像/pdf 文件夹</font></font></li>
<li><code>--langs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指定用于 OCR 的语言。您可以用逗号分隔多种语言（我不建议使用超过）。使用</font><a href="https://en.wikipedia.org/wiki/List_of_ISO_639_language_codes" rel="nofollow"><font style="vertical-align: inherit;">此处的</font></a></font><code>4</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语言名称或两个字母的 ISO 代码</font><font style="vertical-align: inherit;">。Surya 支持 中的 90 多种语言</font><font style="vertical-align: inherit;">。</font></font><a href="https://en.wikipedia.org/wiki/List_of_ISO_639_language_codes" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><code>surya/languages.py</code><font style="vertical-align: inherit;"></font></li>
<li><code>--lang_file</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果您想对不同的 PDF/图像使用不同的语言，您可以在此处指定语言。格式为 JSON 字典，键为文件名，值是列表，例如</font></font><code>{"file1.pdf": ["en", "hi"], "file2.pdf": ["en"]}</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></li>
<li><code>--images</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将保存页面图像和检测到的文本行（可选）</font></font></li>
<li><code>--results_dir</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指定保存结果的目录，而不是默认目录</font></font></li>
<li><code>--max</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果您不想处理所有内容，请指定要处理的最大页数</font></font></li>
<li><code>--start_page</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指定开始处理的页码</font></font></li>
</ul>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该</font></font><code>results.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文件将包含一个 JSON 字典，其中的键是输入文件名（不带扩展名）。每个值都是一个字典列表，输入文档的每个页面对应一个字典。每个页面字典包含：</font></font></p>
<ul dir="auto">
<li><code>text_lines</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- 检测到的每一行的文本和边界框
</font></font><ul dir="auto">
<li><code>text</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- 行中的文本</font></font></li>
<li><code>confidence</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- 模型对检测到的文本的置信度（0-1）</font></font></li>
<li><code>polygon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- 文本行的多边形，格式为 (x1, y1), (x2, y2), (x3, y3), (x4, y4)。这些点从左上角开始按顺时针顺序排列。</font></font></li>
<li><code>bbox</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- （x1，y1，x2，y2）格式的文本行的轴对齐矩形。（x1，y1）是左上角，（x2，y2）是右下角。</font></font></li>
</ul>
</li>
<li><code>languages</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- 页面指定的语言</font></font></li>
<li><code>page</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- 文件中的页码</font></font></li>
<li><code>image_bbox</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- 图像的 bbox 格式为 (x1, y1, x2, y2)。(x1, y1) 是左上角，(x2, y2) 是右下角。所有线 bbox 都将包含在此 bbox 内。</font></font></li>
</ul>
<p dir="auto"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">性能提示</font></font></strong></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">正确设置</font></font><code>RECOGNITION_BATCH_SIZE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">环境变量在使用 GPU 时会产生很大的不同。每个批次项目都将使用</font></font><code>50MB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VRAM，因此批次大小可能非常大。默认批次大小为</font></font><code>256</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，将使用大约 12.8GB 的&ZeroWidthSpace;&ZeroWidthSpace; VRAM。根据您的 CPU 核心数，它也可能有帮助 - 默认 CPU 批次大小为</font></font><code>32</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来自 python</font></font></h3><a id="user-content-from-python" class="anchor" aria-label="永久链接：来自 python" href="#from-python"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-k">from</span> <span class="pl-v">PIL</span> <span class="pl-k">import</span> <span class="pl-v">Image</span>
<span class="pl-k">from</span> <span class="pl-s1">surya</span>.<span class="pl-s1">ocr</span> <span class="pl-k">import</span> <span class="pl-s1">run_ocr</span>
<span class="pl-k">from</span> <span class="pl-s1">surya</span>.<span class="pl-s1">model</span>.<span class="pl-s1">detection</span> <span class="pl-k">import</span> <span class="pl-s1">segformer</span>
<span class="pl-k">from</span> <span class="pl-s1">surya</span>.<span class="pl-s1">model</span>.<span class="pl-s1">recognition</span>.<span class="pl-s1">model</span> <span class="pl-k">import</span> <span class="pl-s1">load_model</span>
<span class="pl-k">from</span> <span class="pl-s1">surya</span>.<span class="pl-s1">model</span>.<span class="pl-s1">recognition</span>.<span class="pl-s1">processor</span> <span class="pl-k">import</span> <span class="pl-s1">load_processor</span>

<span class="pl-s1">image</span> <span class="pl-c1">=</span> <span class="pl-v">Image</span>.<span class="pl-en">open</span>(<span class="pl-v">IMAGE_PATH</span>)
<span class="pl-s1">langs</span> <span class="pl-c1">=</span> [<span class="pl-s">"en"</span>] <span class="pl-c"># Replace with your languages</span>
<span class="pl-s1">det_processor</span>, <span class="pl-s1">det_model</span> <span class="pl-c1">=</span> <span class="pl-s1">segformer</span>.<span class="pl-en">load_processor</span>(), <span class="pl-s1">segformer</span>.<span class="pl-en">load_model</span>()
<span class="pl-s1">rec_model</span>, <span class="pl-s1">rec_processor</span> <span class="pl-c1">=</span> <span class="pl-en">load_model</span>(), <span class="pl-en">load_processor</span>()

<span class="pl-s1">predictions</span> <span class="pl-c1">=</span> <span class="pl-en">run_ocr</span>([<span class="pl-s1">image</span>], [<span class="pl-s1">langs</span>], <span class="pl-s1">det_model</span>, <span class="pl-s1">det_processor</span>, <span class="pl-s1">rec_model</span>, <span class="pl-s1">rec_processor</span>)</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 tooltipped-no-delay d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="from PIL import Image
from surya.ocr import run_ocr
from surya.model.detection import segformer
from surya.model.recognition.model import load_model
from surya.model.recognition.processor import load_processor

image = Image.open(IMAGE_PATH)
langs = [&quot;en&quot;] # Replace with your languages
det_processor, det_model = segformer.load_processor(), segformer.load_model()
rec_model, rec_processor = load_model(), load_processor()

predictions = run_ocr([image], [langs], det_model, det_processor, rec_model, rec_processor)" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文本行检测</font></font></h2><a id="user-content-text-line-detection" class="anchor" aria-label="永久链接：文本行检测" href="#text-line-detection"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">此命令将写出包含检测到的 bbox 的 json 文件。</font></font></p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto"><pre>surya_detect DATA_PATH --images</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 tooltipped-no-delay d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="surya_detect DATA_PATH --images" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<ul dir="auto">
<li><code>DATA_PATH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以是图像、pdf 或图像/pdf 文件夹</font></font></li>
<li><code>--images</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将保存页面图像和检测到的文本行（可选）</font></font></li>
<li><code>--max</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果您不想处理所有内容，请指定要处理的最大页数</font></font></li>
<li><code>--results_dir</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指定保存结果的目录，而不是默认目录</font></font></li>
<li><code>--math</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用专门的数学检测模型，而不是默认模型。这在数学方面会更好，但在其他方面会更差。</font></font></li>
</ul>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该</font></font><code>results.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文件将包含一个 JSON 字典，其中的键是输入文件名（不带扩展名）。每个值都是一个字典列表，输入文档的每个页面对应一个字典。每个页面字典包含：</font></font></p>
<ul dir="auto">
<li><code>bboxes</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- 检测文本的边界框
</font></font><ul dir="auto">
<li><code>bbox</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- （x1，y1，x2，y2）格式的文本行的轴对齐矩形。（x1，y1）是左上角，（x2，y2）是右下角。</font></font></li>
<li><code>polygon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- 文本行的多边形，格式为 (x1, y1), (x2, y2), (x3, y3), (x4, y4)。这些点从左上角开始按顺时针顺序排列。</font></font></li>
<li><code>confidence</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- 模型对检测到的文本的置信度（0-1）</font></font></li>
</ul>
</li>
<li><code>vertical_lines</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- 在文档中检测到垂直线
</font></font><ul dir="auto">
<li><code>bbox</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- 轴线坐标。</font></font></li>
</ul>
</li>
<li><code>page</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- 文件中的页码</font></font></li>
<li><code>image_bbox</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- 图像的 bbox 格式为 (x1, y1, x2, y2)。(x1, y1) 是左上角，(x2, y2) 是右下角。所有线 bbox 都将包含在此 bbox 内。</font></font></li>
</ul>
<p dir="auto"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">性能提示</font></font></strong></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">正确设置</font></font><code>DETECTOR_BATCH_SIZE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">环境变量在使用 GPU 时会产生很大的不同。每个批次项目都将使用</font></font><code>280MB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VRAM，因此批次大小可能非常大。默认批次大小为</font></font><code>32</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，将使用大约 9GB 的 VRAM。根据您的 CPU 核心数量，它也可能有帮助 - 默认 CPU 批次大小为</font></font><code>2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来自 python</font></font></h3><a id="user-content-from-python-1" class="anchor" aria-label="永久链接：来自 python" href="#from-python-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-k">from</span> <span class="pl-v">PIL</span> <span class="pl-k">import</span> <span class="pl-v">Image</span>
<span class="pl-k">from</span> <span class="pl-s1">surya</span>.<span class="pl-s1">detection</span> <span class="pl-k">import</span> <span class="pl-s1">batch_text_detection</span>
<span class="pl-k">from</span> <span class="pl-s1">surya</span>.<span class="pl-s1">model</span>.<span class="pl-s1">detection</span>.<span class="pl-s1">segformer</span> <span class="pl-k">import</span> <span class="pl-s1">load_model</span>, <span class="pl-s1">load_processor</span>

<span class="pl-s1">image</span> <span class="pl-c1">=</span> <span class="pl-v">Image</span>.<span class="pl-en">open</span>(<span class="pl-v">IMAGE_PATH</span>)
<span class="pl-s1">model</span>, <span class="pl-s1">processor</span> <span class="pl-c1">=</span> <span class="pl-en">load_model</span>(), <span class="pl-en">load_processor</span>()

<span class="pl-c"># predictions is a list of dicts, one per image</span>
<span class="pl-s1">predictions</span> <span class="pl-c1">=</span> <span class="pl-en">batch_text_detection</span>([<span class="pl-s1">image</span>], <span class="pl-s1">model</span>, <span class="pl-s1">processor</span>)</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 tooltipped-no-delay d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="from PIL import Image
from surya.detection import batch_text_detection
from surya.model.detection.segformer import load_model, load_processor

image = Image.open(IMAGE_PATH)
model, processor = load_model(), load_processor()

# predictions is a list of dicts, one per image
predictions = batch_text_detection([image], model, processor)" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">布局分析</font></font></h2><a id="user-content-layout-analysis" class="anchor" aria-label="永久链接：布局分析" href="#layout-analysis"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">此命令将写出包含检测到的布局的 json 文件。</font></font></p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto"><pre>surya_layout DATA_PATH --images</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 tooltipped-no-delay d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="surya_layout DATA_PATH --images" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<ul dir="auto">
<li><code>DATA_PATH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以是图像、pdf 或图像/pdf 文件夹</font></font></li>
<li><code>--images</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将保存页面图像和检测到的文本行（可选）</font></font></li>
<li><code>--max</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果您不想处理所有内容，请指定要处理的最大页数</font></font></li>
<li><code>--results_dir</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指定保存结果的目录，而不是默认目录</font></font></li>
</ul>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该</font></font><code>results.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文件将包含一个 JSON 字典，其中的键是输入文件名（不带扩展名）。每个值都是一个字典列表，输入文档的每个页面对应一个字典。每个页面字典包含：</font></font></p>
<ul dir="auto">
<li><code>bboxes</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- 检测文本的边界框
</font></font><ul dir="auto">
<li><code>bbox</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- （x1，y1，x2，y2）格式的文本行的轴对齐矩形。（x1，y1）是左上角，（x2，y2）是右下角。</font></font></li>
<li><code>polygon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- 文本行的多边形，格式为 (x1, y1), (x2, y2), (x3, y3), (x4, y4)。这些点从左上角开始按顺时针顺序排列。</font></font></li>
<li><code>confidence</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- 模型对检测到的文本的置信度（0-1）。目前这不是很可靠。</font></font></li>
<li><code>label</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font><font style="vertical-align: inherit;">边界</font><font style="vertical-align: inherit;">框</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">标签</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">以下</font><font style="vertical-align: inherit;">之一</font></font><code>Caption</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font><font style="vertical-align: inherit;">，，，，，，，，，，，，</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">&ZeroWidthSpace;</font><font style="vertical-align: inherit;">&ZeroWidthSpace;</font></font><code>Footnote</code><font style="vertical-align: inherit;"></font><code>Formula</code><font style="vertical-align: inherit;"></font><code>List-item</code><font style="vertical-align: inherit;"></font><code>Page-footer</code><font style="vertical-align: inherit;"></font><code>Page-header</code><font style="vertical-align: inherit;"></font><code>Picture</code><font style="vertical-align: inherit;"></font><code>Figure</code><font style="vertical-align: inherit;"></font><code>Section-header</code><font style="vertical-align: inherit;"></font><code>Table</code><font style="vertical-align: inherit;"></font><code>Text</code><font style="vertical-align: inherit;"></font><code>Title</code><font style="vertical-align: inherit;"></font></li>
</ul>
</li>
<li><code>page</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- 文件中的页码</font></font></li>
<li><code>image_bbox</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- 图像的 bbox 格式为 (x1, y1, x2, y2)。(x1, y1) 是左上角，(x2, y2) 是右下角。所有线 bbox 都将包含在此 bbox 内。</font></font></li>
</ul>
<p dir="auto"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">性能提示</font></font></strong></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">正确设置</font></font><code>DETECTOR_BATCH_SIZE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">环境变量在使用 GPU 时会产生很大的不同。每个批次项目都将使用</font></font><code>280MB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VRAM，因此批次大小可能非常大。默认批次大小为</font></font><code>32</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，将使用大约 9GB 的 VRAM。根据您的 CPU 核心数量，它也可能有帮助 - 默认 CPU 批次大小为</font></font><code>2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来自 python</font></font></h3><a id="user-content-from-python-2" class="anchor" aria-label="永久链接：来自 python" href="#from-python-2"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-k">from</span> <span class="pl-v">PIL</span> <span class="pl-k">import</span> <span class="pl-v">Image</span>
<span class="pl-k">from</span> <span class="pl-s1">surya</span>.<span class="pl-s1">detection</span> <span class="pl-k">import</span> <span class="pl-s1">batch_text_detection</span>
<span class="pl-k">from</span> <span class="pl-s1">surya</span>.<span class="pl-s1">layout</span> <span class="pl-k">import</span> <span class="pl-s1">batch_layout_detection</span>
<span class="pl-k">from</span> <span class="pl-s1">surya</span>.<span class="pl-s1">model</span>.<span class="pl-s1">detection</span>.<span class="pl-s1">segformer</span> <span class="pl-k">import</span> <span class="pl-s1">load_model</span>, <span class="pl-s1">load_processor</span>
<span class="pl-k">from</span> <span class="pl-s1">surya</span>.<span class="pl-s1">settings</span> <span class="pl-k">import</span> <span class="pl-s1">settings</span>

<span class="pl-s1">image</span> <span class="pl-c1">=</span> <span class="pl-v">Image</span>.<span class="pl-en">open</span>(<span class="pl-v">IMAGE_PATH</span>)
<span class="pl-s1">model</span> <span class="pl-c1">=</span> <span class="pl-en">load_model</span>(<span class="pl-s1">checkpoint</span><span class="pl-c1">=</span><span class="pl-s1">settings</span>.<span class="pl-v">LAYOUT_MODEL_CHECKPOINT</span>)
<span class="pl-s1">processor</span> <span class="pl-c1">=</span> <span class="pl-en">load_processor</span>(<span class="pl-s1">checkpoint</span><span class="pl-c1">=</span><span class="pl-s1">settings</span>.<span class="pl-v">LAYOUT_MODEL_CHECKPOINT</span>)
<span class="pl-s1">det_model</span> <span class="pl-c1">=</span> <span class="pl-en">load_model</span>()
<span class="pl-s1">det_processor</span> <span class="pl-c1">=</span> <span class="pl-en">load_processor</span>()

<span class="pl-c"># layout_predictions is a list of dicts, one per image</span>
<span class="pl-s1">line_predictions</span> <span class="pl-c1">=</span> <span class="pl-en">batch_text_detection</span>([<span class="pl-s1">image</span>], <span class="pl-s1">det_model</span>, <span class="pl-s1">det_processor</span>)
<span class="pl-s1">layout_predictions</span> <span class="pl-c1">=</span> <span class="pl-en">batch_layout_detection</span>([<span class="pl-s1">image</span>], <span class="pl-s1">model</span>, <span class="pl-s1">processor</span>, <span class="pl-s1">line_predictions</span>)</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 tooltipped-no-delay d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="from PIL import Image
from surya.detection import batch_text_detection
from surya.layout import batch_layout_detection
from surya.model.detection.segformer import load_model, load_processor
from surya.settings import settings

image = Image.open(IMAGE_PATH)
model = load_model(checkpoint=settings.LAYOUT_MODEL_CHECKPOINT)
processor = load_processor(checkpoint=settings.LAYOUT_MODEL_CHECKPOINT)
det_model = load_model()
det_processor = load_processor()

# layout_predictions is a list of dicts, one per image
line_predictions = batch_text_detection([image], det_model, det_processor)
layout_predictions = batch_layout_detection([image], model, processor, line_predictions)" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">阅读顺序</font></font></h2><a id="user-content-reading-order" class="anchor" aria-label="永久链接：阅读顺序" href="#reading-order"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">此命令将写出一个具有检测到的阅读顺序和布局的 json 文件。</font></font></p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto"><pre>surya_order DATA_PATH --images</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 tooltipped-no-delay d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="surya_order DATA_PATH --images" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<ul dir="auto">
<li><code>DATA_PATH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以是图像、pdf 或图像/pdf 文件夹</font></font></li>
<li><code>--images</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将保存页面图像和检测到的文本行（可选）</font></font></li>
<li><code>--max</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果您不想处理所有内容，请指定要处理的最大页数</font></font></li>
<li><code>--results_dir</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指定保存结果的目录，而不是默认目录</font></font></li>
</ul>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该</font></font><code>results.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文件将包含一个 JSON 字典，其中的键是输入文件名（不带扩展名）。每个值都是一个字典列表，输入文档的每个页面对应一个字典。每个页面字典包含：</font></font></p>
<ul dir="auto">
<li><code>bboxes</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- 检测文本的边界框
</font></font><ul dir="auto">
<li><code>bbox</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- （x1，y1，x2，y2）格式的文本行的轴对齐矩形。（x1，y1）是左上角，（x2，y2）是右下角。</font></font></li>
<li><code>position</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- bbox 的阅读顺序中的位置，从 0 开始。</font></font></li>
<li><code>label</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- bbox 的标签。请参阅文档的布局部分以获取潜在标签的列表。</font></font></li>
</ul>
</li>
<li><code>page</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- 文件中的页码</font></font></li>
<li><code>image_bbox</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- 图像的 bbox 格式为 (x1, y1, x2, y2)。(x1, y1) 是左上角，(x2, y2) 是右下角。所有线 bbox 都将包含在此 bbox 内。</font></font></li>
</ul>
<p dir="auto"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">性能提示</font></font></strong></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">正确设置</font></font><code>ORDER_BATCH_SIZE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">环境变量在使用 GPU 时会产生很大的不同。每个批次项目都将使用</font></font><code>360MB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VRAM，因此批次大小可能非常大。默认批次大小为</font></font><code>32</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，将使用大约 11GB 的 VRAM。根据您的 CPU 核心数量，它也可能有帮助 - 默认 CPU 批次大小为</font></font><code>4</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来自 python</font></font></h3><a id="user-content-from-python-3" class="anchor" aria-label="永久链接：来自 python" href="#from-python-3"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="highlight highlight-source-python notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-k">from</span> <span class="pl-v">PIL</span> <span class="pl-k">import</span> <span class="pl-v">Image</span>
<span class="pl-k">from</span> <span class="pl-s1">surya</span>.<span class="pl-s1">ordering</span> <span class="pl-k">import</span> <span class="pl-s1">batch_ordering</span>
<span class="pl-k">from</span> <span class="pl-s1">surya</span>.<span class="pl-s1">model</span>.<span class="pl-s1">ordering</span>.<span class="pl-s1">processor</span> <span class="pl-k">import</span> <span class="pl-s1">load_processor</span>
<span class="pl-k">from</span> <span class="pl-s1">surya</span>.<span class="pl-s1">model</span>.<span class="pl-s1">ordering</span>.<span class="pl-s1">model</span> <span class="pl-k">import</span> <span class="pl-s1">load_model</span>

<span class="pl-s1">image</span> <span class="pl-c1">=</span> <span class="pl-v">Image</span>.<span class="pl-en">open</span>(<span class="pl-v">IMAGE_PATH</span>)
<span class="pl-c"># bboxes should be a list of lists with layout bboxes for the image in [x1,y1,x2,y2] format</span>
<span class="pl-c"># You can get this from the layout model, see above for usage</span>
<span class="pl-s1">bboxes</span> <span class="pl-c1">=</span> [<span class="pl-s1">bbox1</span>, <span class="pl-s1">bbox2</span>, ...]

<span class="pl-s1">model</span> <span class="pl-c1">=</span> <span class="pl-en">load_model</span>()
<span class="pl-s1">processor</span> <span class="pl-c1">=</span> <span class="pl-en">load_processor</span>()

<span class="pl-c"># order_predictions will be a list of dicts, one per image</span>
<span class="pl-s1">order_predictions</span> <span class="pl-c1">=</span> <span class="pl-en">batch_ordering</span>([<span class="pl-s1">image</span>], [<span class="pl-s1">bboxes</span>], <span class="pl-s1">model</span>, <span class="pl-s1">processor</span>)</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 tooltipped-no-delay d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="from PIL import Image
from surya.ordering import batch_ordering
from surya.model.ordering.processor import load_processor
from surya.model.ordering.model import load_model

image = Image.open(IMAGE_PATH)
# bboxes should be a list of lists with layout bboxes for the image in [x1,y1,x2,y2] format
# You can get this from the layout model, see above for usage
bboxes = [bbox1, bbox2, ...]

model = load_model()
processor = load_processor()

# order_predictions will be a list of dicts, one per image
order_predictions = batch_ordering([image], [bboxes], model, processor)" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<div class="markdown-heading" dir="auto"><h1 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">限制</font></font></h1><a id="user-content-limitations" class="anchor" aria-label="固定链接：限制" href="#limitations"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这是专门用于文档 OCR 的。它可能不适用于照片或其他图像。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">它适用于印刷文本，而不是手写文本（尽管它可能适用于某些手写文本）。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文本检测模型已经训练自己忽略广告。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可以在 中找到 OCR 的语言支持</font></font><code>surya/languages.py</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。文本检测、布局分析和阅读顺序适用于任何语言。</font></font></li>
</ul>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">故障排除</font></font></h2><a id="user-content-troubleshooting" class="anchor" aria-label="永久链接：故障排除" href="#troubleshooting"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果 OCR 无法正常工作：</font></font></p>
<ul dir="auto">
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">尝试增加图像的分辨率，使文本更大。如果分辨率已经很高，请尝试将其降低到不超过宽度</font></font><code>2048px</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对图像进行预处理（二值化、去倾斜等）可以帮助修复非常旧/模糊的图像。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果结果不佳，  </font><font style="vertical-align: inherit;">您可以调整</font></font><code>DETECTOR_BLANK_THRESHOLD</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和。</font><font style="vertical-align: inherit;">控制行之间的空间 - 任何低于此数字的预测都将被视为空白。  </font><font style="vertical-align: inherit;">控制文本的连接方式 - 任何高于此数字的数字都将被视为文本。  </font><font style="vertical-align: inherit;">应始终高于</font><font style="vertical-align: inherit;">，并且两者都应在 0-1 范围内。查看检测器调试输出中的热图可以告诉您如何调整这些（如果您看到看起来像盒子的微弱的东西，请降低阈值，如果您看到 bbox 连接在一起，请提高阈值）。</font></font><code>DETECTOR_TEXT_THRESHOLD</code><font style="vertical-align: inherit;"></font><code>DETECTOR_BLANK_THRESHOLD</code><font style="vertical-align: inherit;"></font><code>DETECTOR_TEXT_THRESHOLD</code><font style="vertical-align: inherit;"></font><code>DETECTOR_TEXT_THRESHOLD</code><font style="vertical-align: inherit;"></font><code>DETECTOR_BLANK_THRESHOLD</code><font style="vertical-align: inherit;"></font></li>
</ul>
<div class="markdown-heading" dir="auto"><h1 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">手动安装</font></font></h1><a id="user-content-manual-install" class="anchor" aria-label="永久链接：手动安装" href="#manual-install"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果要开发surya，可以手动安装：</font></font></p>
<ul dir="auto">
<li><code>git clone https://github.com/VikParuchuri/surya.git</code></li>
<li><code>cd surya</code></li>
<li><code>poetry install</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- 安装主要和开发依赖项</font></font></li>
<li><code>poetry shell</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- 激活虚拟环境</font></font></li>
</ul>
<div class="markdown-heading" dir="auto"><h1 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">基准</font></font></h1><a id="user-content-benchmarks" class="anchor" aria-label="固定链接：基准测试" href="#benchmarks"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">光学字符识别 (OCR)</font></font></h2><a id="user-content-ocr" class="anchor" aria-label="固定链接：OCR" href="#ocr"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/VikParuchuri/surya/blob/master/static/images/benchmark_rec_chart.png"><img src="/VikParuchuri/surya/raw/master/static/images/benchmark_rec_chart.png" alt="基准图表 tesseract" style="max-width: 100%;"></a></p>
<table>
<thead>
<tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模型</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">每页时间（秒）</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">平均相似度 (⬆)</font></font></th>
</tr>
</thead>
<tbody>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">苏里亚</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.62</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.97</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">立方体</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.45</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.88</font></font></td>
</tr>
</tbody>
</table>
<p dir="auto"><a href="/VikParuchuri/surya/blob/master/static/images/rec_acc_table.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">完整语言结果</font></font></a></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tesseract 基于 CPU，而 surya 是 CPU 或 GPU。我尝试匹配所使用的资源成本，因此我为 surya 使用了 1xA6000（48GB VRAM），为 Tesseract 使用了 28 个 CPU 核心（Lambda Labs/DigitalOcean 上的价格相同）。</font></font></p>
<div class="markdown-heading" dir="auto"><h3 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">谷歌云视觉</font></font></h3><a id="user-content-google-cloud-vision" class="anchor" aria-label="永久链接：Google Cloud Vision" href="#google-cloud-vision"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我将 OCR 与 Google Cloud Vision 进行了对比测试，因为它的语言覆盖范围与 Surya 相似。</font></font></p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/VikParuchuri/surya/blob/master/static/images/gcloud_rec_bench.png"><img src="/VikParuchuri/surya/raw/master/static/images/gcloud_rec_bench.png" alt="谷歌云基准图表" style="max-width: 100%;"></a></p>
<p dir="auto"><a href="/VikParuchuri/surya/blob/master/static/images/gcloud_full_langs.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">完整语言结果</font></font></a></p>
<p dir="auto"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法</font></font></strong></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我根据一组真实世界和合成 PDF 测量了标准化句子相似度（0-1，越高越好）。我从常见的抓取中抽样 PDF，然后过滤掉 OCR 效果较差的 PDF。我找不到某些语言的 PDF，因此我还为这些语言生成了简单的合成 PDF。</font></font></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我使用了 tesseract 和 surya 的 PDF 中的参考线 bbox 来评估 OCR 质量。</font></font></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于 Google Cloud，我将 Google Cloud 的输出与基本事实进行了对齐。我不得不跳过 RTL 语言，因为它们对齐效果不佳。</font></font></p>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文本行检测</font></font></h2><a id="user-content-text-line-detection-1" class="anchor" aria-label="永久链接：文本行检测" href="#text-line-detection-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/VikParuchuri/surya/blob/master/static/images/benchmark_chart_small.png"><img src="/VikParuchuri/surya/raw/master/static/images/benchmark_chart_small.png" alt="基准图表" style="max-width: 100%;"></a></p>
<table>
<thead>
<tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模型</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">时间（秒）</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">每页时间（秒）</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">精确</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">记起</font></font></th>
</tr>
</thead>
<tbody>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">苏里亚</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">52.6892</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.205817</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.844426</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.937818</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">立方体</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">74.4546</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.290838</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.631498</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.997694</font></font></td>
</tr>
</tbody>
</table>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tesseract 基于 CPU，而 surya 是 CPU 或 GPU。我在具有 A6000 GPU 和 32 核 CPU 的系统上运行了基准测试。这是资源使用情况：</font></font></p>
<ul dir="auto">
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tesseract - 32 个 CPU 核心，或 8 个工作器，每个工作器使用 4 个核心</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">surya - 批处理大小为 32，用于 9GB VRAM 使用</font></font></li>
</ul>
<p dir="auto"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法</font></font></strong></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Surya 预测行级边界框，而 tesseract 和其他预测词级或字符级边界框。很难找到 100% 正确的带有行级注释的数据集。合并边界框可能会产生噪音，因此我选择不使用 IoU 作为评估指标。</font></font></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我改用覆盖率，其计算结果为：</font></font></p>
<ul dir="auto">
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">精度 - 预测的边界框与真实边界框的覆盖程度</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">召回率 - 真实边界框与预测边界框的覆盖程度</font></font></li>
</ul>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">首先计算每个 bbox 的覆盖率，然后对双重覆盖率添加一个小惩罚，因为我们希望检测具有不重叠的 bbox。覆盖率为 0.5 或更高的任何内容都被视为匹配。</font></font></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">然后我们计算整个数据集的精度和召回率。</font></font></p>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">布局分析</font></font></h2><a id="user-content-layout-analysis-1" class="anchor" aria-label="永久链接：布局分析" href="#layout-analysis-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/VikParuchuri/surya/blob/master/static/images/benchmark_layout_chart.png"><img src="/VikParuchuri/surya/raw/master/static/images/benchmark_layout_chart.png" alt="基准图表" style="max-width: 100%;"></a></p>
<table>
<thead>
<tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">布局类型</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">精确</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">记起</font></font></th>
</tr>
</thead>
<tbody>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图像</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.95</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.99</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">桌子</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.95</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.96</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文本</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.89</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.95</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标题</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.92</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.89</font></font></td>
</tr>
</tbody>
</table>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">每张图像的时间 - GPU（A6000）上为 0.79 秒。</font></font></p>
<p dir="auto"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法</font></font></strong></p>
<p dir="auto"><font style="vertical-align: inherit;"></font><a href="https://github.com/ibm-aur-nlp/PubLayNet"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我对Publaynet</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的布局分析进行了基准测试</font><font style="vertical-align: inherit;">，而训练数据中没有这个功能。我必须将 publaynet 标签与 surya 布局标签对齐。然后我就能找到每种布局类型的覆盖范围：</font></font></p>
<ul dir="auto">
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">精度 - 预测的边界框与真实边界框的覆盖程度</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">召回率 - 真实边界框与预测边界框的覆盖程度</font></font></li>
</ul>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">阅读顺序</font></font></h2><a id="user-content-reading-order-1" class="anchor" aria-label="固定链接：阅读顺序" href="#reading-order-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在 A6000 GPU 上，平均准确率 75%，每张图像耗时 0.14 秒。请参阅方法论中的注释 - 此基准并非准确率的完美衡量标准，更适合用作健全性检查。</font></font></p>
<p dir="auto"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法</font></font></strong></p>
<p dir="auto"><font style="vertical-align: inherit;"></font><a href="https://www.icst.pku.edu.cn/cpdp/sjzy/" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我对此处的</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">布局数据集进行了基准测试</font><font style="vertical-align: inherit;">，该数据集不在训练数据中。不幸的是，这个数据集相当嘈杂，并非所有标签都是正确的。很难找到一个带有阅读顺序和布局信息注释的数据集。我想避免使用云服务来获取基本事实。</font></font></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">准确度的计算方法是：检查每对布局框的顺序是否正确，然后取正确的百分比。</font></font></p>
<div class="markdown-heading" dir="auto"><h2 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">运行自己的基准测试</font></font></h2><a id="user-content-running-your-own-benchmarks" class="anchor" aria-label="永久链接：运行你自己的基准测试" href="#running-your-own-benchmarks"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可以在您的机器上对 surya 的性能进行基准测试。</font></font></p>
<ul dir="auto">
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">按照上面的手动安装说明进行操作。</font></font></li>
<li><code>poetry install --group dev</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- 安装开发依赖项</font></font></li>
</ul>
<p dir="auto"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文本行检测</font></font></strong></p>
<p dir="auto"><font style="vertical-align: inherit;"></font><a href="https://huggingface.co/datasets/vikp/doclaynet_bench" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这将评估 tesseract 和 surya 在从doclaynet</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">随机采样的一组图像中进行文本行检测的能力</font><font style="vertical-align: inherit;">。</font></font></p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto"><pre class="notranslate"><code>python benchmark/detection.py --max 256
</code></pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 tooltipped-no-delay d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="python benchmark/detection.py --max 256" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<ul dir="auto">
<li><code>--max</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">控制基准测试需要处理的图像数量</font></font></li>
<li><code>--debug</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将渲染图像并检测到的框</font></font></li>
<li><code>--pdf_path</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将允许您指定 pdf 来作为基准，而不是默认数据</font></font></li>
<li><code>--results_dir</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将允许您指定保存结果的目录，而不是默认目录</font></font></li>
</ul>
<p dir="auto"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文本识别</font></font></strong></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这将评估来自常见抓取的多语言 PDF 上的 surya 和可选的 tesseract（使用缺失语言的合成数据）。</font></font></p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto"><pre class="notranslate"><code>python benchmark/recognition.py --tesseract
</code></pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 tooltipped-no-delay d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="python benchmark/recognition.py --tesseract" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<ul dir="auto">
<li><code>--max</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">控制基准测试需要处理的图像数量</font></font></li>
<li><code>--debug 2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将呈现检测到的文本的图像</font></font></li>
<li><code>--results_dir</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将允许您指定保存结果的目录，而不是默认目录</font></font></li>
<li><code>--tesseract</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将使用 tesseract 运行基准测试。您必须运行</font></font><code>sudo apt-get install tesseract-ocr-all</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以安装所有 tesseract 数据，并设置</font></font><code>TESSDATA_PREFIX</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为 tesseract 数据文件夹的路径。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">设置</font></font><code>RECOGNITION_BATCH_SIZE=864</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为使用与基准相同的批次大小。</font></font></li>
</ul>
<p dir="auto"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">布局分析</font></font></strong></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这将在 publaynet 数据集上评估 surya。</font></font></p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto"><pre class="notranslate"><code>python benchmark/layout.py
</code></pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 tooltipped-no-delay d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="python benchmark/layout.py" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<ul dir="auto">
<li><code>--max</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">控制基准测试需要处理的图像数量</font></font></li>
<li><code>--debug</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将呈现检测到的文本的图像</font></font></li>
<li><code>--results_dir</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将允许您指定保存结果的目录，而不是默认目录</font></font></li>
</ul>
<p dir="auto"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">阅读顺序</font></font></strong></p>
<div class="snippet-clipboard-content notranslate position-relative overflow-auto"><pre class="notranslate"><code>python benchmark/ordering.py
</code></pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 tooltipped-no-delay d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="python benchmark/ordering.py" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<ul dir="auto">
<li><code>--max</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">控制基准测试需要处理的图像数量</font></font></li>
<li><code>--debug</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将呈现检测到的文本的图像</font></font></li>
<li><code>--results_dir</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将允许您指定保存结果的目录，而不是默认目录</font></font></li>
</ul>
<div class="markdown-heading" dir="auto"><h1 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">训练</font></font></h1><a id="user-content-training" class="anchor" aria-label="固定链接：培训" href="#training"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文本检测在 4 台 A6000 上训练了 3 天。它使用一组不同的图像作为训练数据。它是使用经过修改的 segformer 架构从头开始训练的，该架构可降低推理 RAM 要求。</font></font></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文本识别在 4x A6000 上训练了 2 周。使用修改后的甜甜圈模型（GQA、MoE 层、UTF-16 解码、层配置更改）进行训练。</font></font></p>
<div class="markdown-heading" dir="auto"><h1 tabindex="-1" class="heading-element" dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">谢谢</font></font></h1><a id="user-content-thanks" class="anchor" aria-label="永久链接：谢谢" href="#thanks"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果没有出色的开源 AI 工作，这项工作就不可能实现：</font></font></p>
<ul dir="auto">
<li><a href="https://arxiv.org/pdf/2105.15203.pdf" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NVIDIA 的</font><a href="https://arxiv.org/pdf/2105.15203.pdf" rel="nofollow"><font style="vertical-align: inherit;">Segformer</font></a></font></li>
<li><a href="https://github.com/clovaai/donut"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Naver 的</font><a href="https://github.com/clovaai/donut"><font style="vertical-align: inherit;">甜甜圈</font></a></font></li>
<li><a href="https://github.com/huggingface/transformers"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">huggingface 的</font><a href="https://github.com/huggingface/transformers"><font style="vertical-align: inherit;">变形金刚</font></a></font></li>
<li><a href="https://github.com/clovaai/CRAFT-pytorch"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CRAFT</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，一个很棒的场景文本检测模型</font></font></li>
</ul>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">感谢所有使开源 AI 成为可能的人。</font></font></p>
</article></div>
